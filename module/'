{ landingpage }:
{ config, lib, pkgs, ... }:

with lib;

let
  cfg = config.home.landingpage;



    mkMagicMergeOption = { description ? "", example ? { }, default ? { }, ... }:
    mkOption {
      inherit example description default;
      type = with lib.types;
        let
          valueType = nullOr
            (oneOf [
              bool
              int
              float
              str
              string
              (attrsOf valueType)
              (listOf valueType)
            ]) // {
            description = "";
            emptyValue.value = { };
          };
        in
        valueType;
    };

in
{

  options.home.landingpage =
    {
      enable = mkEnableOption "landingpage";
      config = mkMagicMergeOption {
        description = "landingpage configuration";
        default = [
         {
            text = "Landing Page (Masonry)";
            items = [
              {
               url = "https://nixos.org/";
                label = "NixOS";
                image = "https://raw.githubusercontent.com/NixOS/nixos-artwork/master/logo/nix-snowflake.svg";
              }
            ];
          }
       ];
      };
    };

  config = mkIf cfg.enable {
    home.file."Desktop/landingpage.html".source = "${landingpage.override { jsonConfig =  cfg.config ; }}/index.html";
  };

}
